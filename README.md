# Li'l Video

Маленький відеоплеєр для [Лілки](https://github.com/and3rson/lilka). Дозволяє відтворювати відео зі звуком (MJPEG + AAC), спеціально підготовлене та складене в папку Video на SD-карті.

[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/Hq1uq1eL9xs/mqdefault.jpg)](https://www.youtube.com/watch?v=Hq1uq1eL9xs)

https://youtu.be/Hq1uq1eL9xs

## Збирання

Проєкт створено для [PlatformIO](https://platformio.org/). Клонуйте, або скачайте цей репозиторій:

```console
git clone https://github.com/noisedsn/lilvideo
```

Відкрийте у PlatformIO та натисніть Build, далі, в теорії, все відбудеться автоматично.

Ну або просто скачайте готовий файл [player.bin](player.bin).

## Встановлення та додавання відео

В корені SD-карти створіть директорію Video. Помістіть в неї бінарник player.bin (Насправді, неважливо, де він лежатиме, але відео він буде шукати саме в цій папці і зручніше, коли все в одному місці).

Відео повинні бути сконвертовані в два окремих файли з фіксованими іменами: 288_30fps.mjpeg та 44100.aac. Для конвертації вам знадобиться [ffmpeg](https://www.ffmpeg.org/) та трохи консольних вправ:

```console
ffmpeg -i input.mp4 -vf "fps=30,scale=-1:240:flags=lanczos,crop=288:in_h:(in_w-288)/2:0" -q:v 11 288_30fps.mjpeg
```

```console
ffmpeg -i input.mp4 -ar 44100 -ac 1 -ab 36k -filter:a normalize -filter:a "volume=-6dB" 44100.aac
```
...де input.mp4 - вхідний відеофайл. Можна погратися з якістю відео параметром `-q:v 11` в першій команді, змінюючи число 11 від 2 (найкраща якість) до 31 (найменший файл). Бітрейт аудіо можна змінювати в другій команді параметром `-ab 36k`, але не варто знижувати менш ніж до 24k, якість падає драматично. Якщо звук хрипить, можна змінити `volume=-6dB` до -12...-15dB.

В директорії Video поряд з player.bin створюйте підпапки для кожного відео і кладіть в них обидва файли:

```
Video/
├── Ролик 1
│   ├── 288_30fps.mjpeg
│   └── 44100.aac
├── Ролик 2
│   ├── 288_30fps.mjpeg
│   └── 44100.aac
├── Ще одне відео
│   ├── 288_30fps.mjpeg
│   └── 44100.aac
└── player.bin
```

## Керування
...як такого, поки немає. Заходьте через Браузер SD-карти в папку Video і запускайте player.bin. Далі, вибір відео - вгору-вниз лівими кнопками, запуск обраного відео - кнопкою А. 

Під час відтворення, кнопками вгору/вниз регулюється гучність; натискання кнопки А - закриє плеєр та поверне в Keira OS.